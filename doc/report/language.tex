\section{Language}
\label{sec:language}
\begin{figure}[!ht]
\small
\centering
\begin{grammar}%
\begin{tabular}{r r l}
$~$\nonterm{t} & \: & \nonterm{c} \| \nonterm{x} \| \KW{new} $\mu_1\mu_2$\nonterm{T} \| \KW{let} \nonterm{m}(\nonterm{x}:$\mu_1\mu_2$\nonterm{T}):\nonterm{T} = \nonterm{t} \| $\lambda$\nonterm{x}:$\mu_1\mu_2$\nonterm{T}.\nonterm{t} \| \nonterm{t}\nonterm{t} \| $\lambda$\nonterm{X}.\nonterm{t} \| \nonterm{t}[\nonterm{T}] 
& & \| \{\nonterm{t},\nonterm{t}\} \| \nonterm{t}.1 \| \nonterm{t}.2
$~$\nonterm{v} & \: & \nonterm{c} \| $\lambda$\nonterm{x}:$\mu_1\mu_2$\nonterm{T}.\nonterm{t} \| $\lambda$\nonterm{X}.\nonterm{t} \| \{\nonterm{v},\nonterm{v}\}
$~$\nonterm{T}$_s$ & \: & \nonterm{B} \| \nonterm{X} \| \nonterm{T}$\to$\nonterm{T} \| $\forall$\nonterm{X}.\nonterm{T} \| \nonterm{T}$\times$\nonterm{T}
$~\Gamma_s$ & \: & $\emptyset$ \| $\Gamma$, \nonterm{x}:\nonterm{T} \| $\Gamma$,\nonterm{X}
$~\mu_1$ & \: & \KW{any} \| \KW{sep}
$~\mu_2$ & \: & \KW{any} \| \KW{local} \| \KW{mut} \| \KW{shr}
\end{tabular} %
\end{grammar}
\caption{The syntax of the programming language.}
\label{fig:syntax}
\end{figure}
\subsection{Types}
\begin{figure}[!ht]
\begin{mathpar}
\inferrule[(\emph{O\_Intro})]{ }{mut \MSUBTYPE shr}

\inferrule[(\emph{O\_Ma})]{ }{\mu \MSUBTYPE any}

\inferrule[(\emph{O\_Refl})]{ }{\mu \MSUBTYPE \mu}
\end{mathpar}
\caption{Ordering of modifier}
\label{fig:order-mod}
\end{figure}
\begin{figure}[!ht]
\begin{mathpar}
\inferrule[(\emph{ST\_Refl})]{ }
{ \TypJudg{}{T ~ \SUBTYPE T}} 

\inferrule[(\emph{ST\_Fun})]{ \TypJudg{}{T_1 \SUBTYPE T_1'} \\ \TypJudg{}{T_2' \SUBTYPE T_2}}
{\TypJudg{}{T_1' \mapsto T_2' \SUBTYPE T_1 \mapsto T_2}}

\inferrule[(\emph{ST\_Trans})]{  \TypJudg{}{T_1 \SUBTYPE T_2} \\ \TypJudg{}{T_2 \SUBTYPE T_3 }}
{ \TypJudg{}{T_1 ~ \SUBTYPE T_3}} \\

\end{mathpar}
\caption{Typing rules for subtypes}
\label{fig:subtypes}
\end{figure}

\subsection{Semantics}
\begin{figure}[!ht]
\small
\centering
\begin{grammar}%
\begin{tabular}{r r l}
$~$\nonterm{s} & \: & $\overline{x \mapsto v}$
$~$\nonterm{h} & \: & $\overline{(l \mapsto o)}$
$~$\nonterm{l} & \: & Address
$~$\nonterm{v} & \: & \nonterm{l} \| \nonterm{null}$_l$ \| $\lambda$\nonterm{x}:\nonterm{T}$_r$.\nonterm{t} \| \{\nonterm{v},\nonterm{v}\}
$~$\nonterm{o}$_l$ & \: & \nonterm{l}
$~$\nonterm{o}$_m$ & \: & \nonterm{m}
$~\mu$ & \: & \KW{mut} \| \KW{shr}
$~$\nonterm{T}$_r$ & \: & \nonterm{B} \| (\nonterm{o}$_{l}$,\nonterm{T}$_r\times$\nonterm{T}$_r$) \| (\nonterm{ref}$_\mu$,\nonterm{T}$_r$) \|(\nonterm{o}$_m$,$\lambda$\nonterm{x}:$\mu_1\mu_2$\nonterm{T}$_r$.\nonterm{t}) \| (\nonterm{o}$_m$,$\lambda$\nonterm{X}.\nonterm{t}) 
$~\Gamma_r$ & \: & $\emptyset$ \| $\Gamma$, \nonterm{X} $\mapsto$ \nonterm{T}$_r$ \| $\Gamma$,\nonterm{x} $\mapsto$ v
\end{tabular} %
\end{grammar}
\caption{Definition of the runtime model.}
\label{fig:runtime}
\end{figure}


